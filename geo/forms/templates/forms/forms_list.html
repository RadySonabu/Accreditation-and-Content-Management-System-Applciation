{% extends "dashboard/base.html" %}

{% block content %}
{% load crispy_forms_tags %}

<h3><strong>
    <form method="POST" load-url="{% url 'load-forms'%}" novalidate>
        <label>Select Year:</label>
        <select class="country">
            <!-- <option value="">-------------</option> -->
            <option value="2019">2019</option>
            <option value="2020">2020</option>
            <option value="2021">2021</option>
        </select>
        
      </form>
</strong></h3>



  

{% if user.role.role == 'COLLEGE DEAN'  and form.created_by == user.instance %}

<!-- <form method="POST"> -->
{% csrf_token %}
<!-- <fieldset class=""> -->
<legend  class="border-bottom mb-4" style="color: 2px solid black"><h2><strong>List of Forms <a href="{% url 'form-create' a %}"><i
      class="fa fa-plus"></i></a></strong></h2>
</legend>
<div class="row col-md-12">



  <!-- 
                        
                        {% if form.created_by == user  %}
                        <h2><a class="article-title" href="{% url 'form-detail' form.id %}">{{ form.title}}</a></h2>
                        {% endif %} -->

  {% for f in f %}

  {% if f.created_by == user or f.is_active == True %}



  {% if f.year == 2019 and  f.type_of_accreditation.id == a  %}



    
    <a href="{% url 'detail-form' f.id %}" class="block full-width m-b bounce">

        <div class="col-md-3 p-2 bounce">
          <div class="payment-card" style="box-shadow: 0px 3px 5px -1px rgba(0, 0, 0, 0.2),
          0px 5px 8px 0px rgba(0, 0, 0, 0.14),
          0px 1px 14px 0px rgba(0, 0, 0, 0.12); background: rgba(85, 85, 85, 0.12);border-top: 2px solid rgb(15, 15, 15)">
            <div class=" text-center" style="justify-content: center">
             
                <h4 class="card-title">{{ f.type_of_accreditation}}</h4>
                  <h5 class="card-title">{{ f.created_for}}</h5>
      
      
      
                  <img class="avatar" src="/media/{{f.type_of_accreditation.image}}" alt="..." style="width: 50%">
                  <h2 class="card-title">{{ f.year}}</h2>
                  <div class="progress progress-mini">
      
                    {% if f.percent >= 80 %}
                    <div style=" width: {{f.percent}}%; background-color: blue;" class="progress-bar"></div>
                    {% elif f.percent >= 60%}
                    <div style=" width: {{f.percent}}%; background-color: green;" class="progress-bar"></div>
                    {% elif f.percent >= 50%}
                    <div style=" width: {{f.percent}}%; background-color: orange;" class="progress-bar"></div>
                    {% elif f.percent < 50%}
                    <div style=" width: {{f.percent}}%; background-color: red;" class="progress-bar"></div>
                    {% endif %}
      
                  </div>
                  <div><h3>{{f.percent}}%</h3></div>
              </a>
            </div>
          </div>
        </div>
    
  





  {% endif %}
  <!-- end of year and type of -->


  {% endif %}
  <!-- end of f.created -->
  {% endfor %}
  <!-- end of for f in f -->



</div>
<!-- </fieldset> -->

<!-- </form> -->
<div id="forms_dean" ></div>

  {%else%}
  Oops page not found!
  {% endif %}


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    $(document).ready(function(){
    $("select.country").change(function(){
        var selectedCountry = $(this).children("option:selected").val();
        var url = $("#forms_dean").attr("load-url");
        console.log(selectedCountry);

        $.ajax({                       // initialize an AJAX request
        url: url,              // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'year': selectedCountry       // add the country id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_cities` view function
          // location.html(data)
          // $("#forms_dean").html(data)
          console.log("Bobo"); // replace the contents of the city input with the data that came from the server
        }
      });

    });
});
 </script>
{% endblock %}